{
  "manifestVersion": "1",
  "name": "nativeemitinstall",
  "version": "1.0.0",
  "publisher": "rKdrRL3dVhfXVqx3FPMB9Ef6BXSmuwzFXr",
  "repo": "https://github.com/Handy4ndy/NativeEmitInstall",
  "networks": [
    "xahau-testnet"
  ],
  "roles": {
    "installer": {
      "label": "Installer Account",
      "description": "The account installing the hook"
    }
  },
  "hooks": [
    {
      "id": "main",
      "artifact": {
        "toolchain": "hooks-c",
        "source_path": "src/hook.c"
      },
      "HookOn": [
        "PAYMENT"
      ],
      "HookCanEmit": [
        "PAYMENT"
      ],
      "HookParameters": [
        {
          "HookParameterName": "AMT_IN",
          "HookParameterValue": {
            "type": "userConfig",
            "value": "{{AMT_IN}}"
          }
        },
        {
          "HookParameterName": "AMT_OUT",
          "HookParameterValue": {
            "type": "userConfig",
            "value": "{{AMT_OUT}}"
          }
        },
        {
          "HookParameterName": "F_ACC",
          "HookParameterValue": {
            "type": "userConfig",
            "value": "{{F_ACC}}"
          }
        }
      ],
      "abi": {
        "notes": "Install Native Emit (INE) hook: Validates incoming XAH payments against configured exact amount, then emits outgoing payment to specified account. All hook parameters are installer-configured and trusted. Hook operates on PAYMENT transactions only.",
        "hookParameters": [
          {
            "name": "AMT_IN",
            "description": "Exact incoming payment amount in XAH (converted to drops internally via 1M multiplier)",
            "selector": [
              {
                "type": "VarString",
                "pattern": "AMT_IN",
                "patternEncoding": "ascii"
              }
            ],
            "data": [
              {
                "type": "UInt64",
                "label": "amount_xah",
                "notes": "Value in XAH units. Code multiplies by 1,000,000 to convert to drops. Must be > 0. Overflow check: value must be <= UINT64_MAX / 1,000,000 (approx 18.4 exaXAH)"
              }
            ]
          },
          {
            "name": "AMT_OUT",
            "description": "Outgoing payment amount in XAH to emit to F_ACC (converted to drops internally via 1M multiplier)",
            "selector": [
              {
                "type": "VarString",
                "pattern": "AMT_OUT",
                "patternEncoding": "ascii"
              }
            ],
            "data": [
              {
                "type": "UInt64",
                "label": "amount_xah",
                "notes": "Value in XAH units. Code multiplies by 1,000,000 to convert to drops. Must be > 0. Overflow check: value must be <= UINT64_MAX / 1,000,000 (approx 18.4 exaXAH)"
              }
            ]
          },
          {
            "name": "F_ACC",
            "description": "Destination account for emitted payment transaction (first account in forward chain)",
            "selector": [
              {
                "type": "VarString",
                "pattern": "F_ACC",
                "patternEncoding": "ascii"
              }
            ],
            "data": [
              {
                "type": "AccountID",
                "label": "destination_account",
                "notes": "Must be exactly 20 bytes. Must differ from hook account (validated at runtime). Receives the emitted payment of AMT_OUT"
              }
            ]
          }
        ]
      }
    }
  ],
  "install": [
    {
      "TransactionType": "SetHook",
      "description": "Install Native Emit",
      "required": true,
      "role": "installer",
      "hookIds": [
        "main"
      ]
    }
  ],
  "description": "This hook emits a native payment to a user-defined account and amount, configured via install parameters. It only triggers when incoming XAH payments match the exact amount specified during installation.",
  "license": "MIT",
  "userConfig": {
    "AMT_IN": {
      "label": "Incoming payment amount",
      "inputType": "uint64",
      "encoding": "uint64",
      "default": "10",
      "description": "This is the amount the hooks is expecting to recieve to initiate the forwarding transaction",
      "required": true,
      "validation": {
        "min": 1,
        "max": 100000000
      }
    },
    "AMT_OUT": {
      "label": "Outgoing payment amount.",
      "inputType": "uint64",
      "encoding": "uint64",
      "default": "10",
      "description": "This is the amount that will be forwarded to the specifed account.",
      "required": true,
      "validation": {
        "min": 1,
        "max": 100000000
      }
    },
    "F_ACC": {
      "label": "Recieving Account",
      "inputType": "account",
      "encoding": "hex",
      "default": "r4NgXudYJxWszvjNjMvDCBjXVUhcLxQ49y",
      "description": "This is the account that will be recieving the forwarded Xah Payment",
      "required": true
    }
  }
}